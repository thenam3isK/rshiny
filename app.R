## Import Libraries ##
library(shiny)
library(shinydashboard)
library(readxl)
library(ggplot2)
library(dplyr)
library(leaflet)
library(purrr)
library(DT)
library(data.table)
library(htmltools)




## Create a table with more organised data ##
data <- data.table(
  station = c("Anp Chour", "Baglung", "Bahrabise", "Baitadi", "Bajura (Martadi)", "Bandipur", "Begnas", "Beni Bazar", "Besishahar", "Bhairahawa (Agric)", "Bhairahawa Airport", "Bhaktapur", "Bharatpur", "Bhimgithhe", "Bhorletar", "Bijuwar Tar", "Biratnagar Airport", "Birganj", "Buddhanilakantha", "Butwal", "Chainpur (East)", "Chainpur (West)", "Chainpur Bajhang Aws Climate", "Chandra Gadhi",
              "Changu Narayan", "Chapkot", "Charikot", "Chatara", "Chaurjhari Tar", "Chautara", "Chhoser", "Chisapani(Karnali)", "Dadeldhura", "Dailekh", "Dainsili", "Damak", "Daman", "Damauli", "Dandaswara", "Darchula", "Darchula New", "Dhading", "Dhangadhi(Attariya)", "Dhankuta", "Dharan Bazar", "Dhulikhel", "Dhunche", "Dhunibesi", "Diktel", "Dipal Gaun", "Dipayal (Doti)", "Dumkauli",
              "Dunai", "Gaida (Kankai)", "Gam Shree Nagar", "Gaur", "Ghale Kharka", "Ghorai (Dang)", "Godavari", "Godavari(West)", "Gokuleshwar", "Gorkha", "Gulariya","Gurja Khani", "Hardinath", "Hetaunda N.f.i.", "Humde", "Ilam Tea Estate", "Jajarkot", "Jalesore", "Janakpur Airport", "Jhingrana", "Jiri", "Jomsom", "Jumla", "Jumla A/P", "Jyamirebari", "Kabre", "Kaigaun", "Kakani", "Kanyam Tea Estate",
              "Karmaiya", "Kathmandu Airport", "Kechana", "Khadbari", "Khairini Tar", "Khajura (Nepalganj)", "Khanchikot", "Khokana", "Khudi Bazar", "Khumaltar", "Kushma", "Lahan", "Lete", "Libang Gaun", "Lumbini", "Lumbini Mandir", "Lumle", "Mahendra Nagar", "Malepatan (Pokhara)", "Mandan", "Mangalsen", "Manma", "Manthali", "Manusmara", "Mehalkuna", "Musikot(Rukumkot)", "Nagarkot", "Nagma",
              "Nepalgunj Airport", "Nepalgunj(Reg.off.)", "Num", "Nuwakot", "Okhaldhunga", "Oli Gaun (Patkani)", "Pakhribas", "Panchase", "Panchkhal", "Panipokhari(Kathmandu)", "Pansayakhola", "Parasi", "Parwanipur", "Patan (West)", "Patan New", "Phatepur", "Phidim (Panchther)", "Pokhara Airport", "Pokhara Reg. Off.", "Pusma Camp", "Rajbiraj", "Rampur", "Rani Jaruwa Nursery", "Rara", "Salleri",
              "Salyan Bazar", "Sandhikharka", "Sarmathang", "Semari", "Sikta", "Silgadhi Doti", "Simara Airport", "Simikot", "Sindhuli Madhi", "Siraha", "Surkhet (Birendra Nagar)", "Syangja", "Tamghas", "Tansen", "Taplejung", "Tarahara", "Taulihawa", "Terhathum", "Thakmarpha", "Tikapur", "Timure", "Tulsipur", "Udayapur Gadhi"),
  
  year = c(c(2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,
             2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,2013,
             2013,2013,2013,2013,2013), c(2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,
             2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,
             2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014), c(2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,
             2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,
             2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015,2015), c(2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,
             2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,
             2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016,2016), c(2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,
             2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,
             2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017,2017)),
  
  min = c(c(NA, NA, NA, 9.1, 9.5, 15.6, 15.8, NA, NA, 18, 19.1, NA, 27.4, NA, NA, 15.7, 19.3, NA, NA, NA, 12.4, NA, 12.9, 19.5, 13.2, 16.9, 11, NA, NA, NA, 0.1, 18.8, 11.4, 14.3, NA, NA, NA, 17.9, 11.7, 12.6, 14.7, NA, 18.1, 15.2, 20.3, NA, NA, 15.8, NA, 5.3, 16, 19.2, 8.8, 18.4, 11, 17.1, NA, 16.2, 9.3, 20.2, 15.1, 17, NA, NA, NA, 17.2, NA, NA, NA, 19.2, 19.7, 12.9, 8.9, 6.2, 5.5, 5.0, NA, 12.0,
            NA, 11.3, 10.1, 20.1, 12.9, 19.2, 15.8, 17.1, 18.5, 12.9, 11.2, 15.7, 12.6, 15, 19.7, 6.4, NA, NA, 18.8, 12.4, 18.0, 14.6, NA, NA, NA, 18.1, 19, NA, NA, 10.4, NA, 18.3, 19.5, NA, 16.1, 11.5, NA, 12.4, NA, NA, 13.6, NA, 17.7, 19.4, 13.2, 13.4, 17.6, 15.8, 16.1, NA, NA, 19.6, NA, 20.2, NA, 2.6, 14.6, NA, NA, 15.5, 16.5, NA, 17.7, NA, 17.3, 17.7, 15.7, 15.5, NA, 15.4, 12.1, 17.8, 18.6, 
            11.8, 5.5, 17.9, 11.8, NA, NA), c(13.7, NA, 14.6, 7.5, 11.7, 16, 15.9, NA, NA, 18.6, 19, 11.2, 19.4, NA, NA, NA, 19.4, NA, NA, 19.6, 13.6, NA, NA, 19.1, 13.1, 17.2, NA, NA, 14.7, NA, NA, 19.3, 11.5, 13.9, NA, NA, NA, NA, 10.9, 13.6, NA, NA, 17.4, 15.3, 20.2, 12.1, NA, 16, NA, NA, 15.9, 18.9, 8.5, 18.2, NA, NA, 12.6, 16.2, 9.6, NA, NA, NA, NA, NA, 19.2, 17.2, NA, 13.3, NA, NA, 19.8, NA,
            8.6, 5.8, 4.9, 4.4, 11.8, 12, NA, 11.6, 10.1, 20.2, 13, 19, 16.3, 17.3, 18.3, 12.3, 10.9, NA, 12.6, 14.9, NA, NA, 11.5, 18.6, 18.6, 12.2, 17.7, 15.3, NA, NA, NA, 17, 18.6, NA, 12.1, 10.5, NA, 18, 19.4, NA, 16.5, 12.3, NA, 12.5, NA, NA, 13.7, NA, 18.8, 19.2, 13.1, NA, 19.3, 15.7, 15.9, NA, 14.1, 19.9, 17.9, 20.4, NA, NA, 14.5, NA, 6.9, NA, 17.2, 12.9, 17.6, NA, NA, 16.7, 15.4, 15.5,
            12.2, 15.5, 12.4, 18.1, NA, 11.8, 4.8, 18.4, 11, NA, NA), c(NA, 15.4, NA, 8.1, 12.2, 16, 16.3, NA, NA, 19.4, 19.3, 12, 19.4, NA, 18.4, 15.3, 19.8, NA, NA, 19.5, 13.5, NA, NA, 19.4, 13.1, 17.3, NA, 19.9, 14.9, NA, NA, 19.5, 11.7, 14, NA, 16.6, NA, NA, 13.1, 13.8, 14.7, NA, 17.9, 15.4, 20.4, 11.9, NA, 16.6, 14, 4.5, 15.7, 19.1, NA, 18.5, NA, NA, 12.8, 16.4, 11.4, 19.8, 14.6, 17, 18.7,
            NA, 19.8, 17.4, NA, 13.9, NA, 18.8, 20.1, NA, 8.9, 5.9, 5.3, 4.3, 12.5, 12, NA, 11.6, 12.5, 20.3, 13, 19.4, 16.5, 17.3, 18.7, 11.9, 11.1, NA, 12.5, 15.1, 19.9, 6.3, 9.8, 18.8, 18.8, 12.2, 18.3, 15.8, NA, 13.6, NA, 16.7, 19.6, 16.6, 12.2, 10.3, 8.1, 18.5, 19.8, NA, NA, 12.9, NA, NA, NA, NA, 14.7, NA, 19, 19.2, 12.7, 13.4, 19.9, NA, 16.4, NA, 15, 20.7, 18.1, NA, 3.8, NA, 14.2, 13.7, NA,
            17.9, 17.8, 13.5, 18.5, NA, NA, 15.7, 15.5, NA, 12.2, 14.8, 12.5, 18.7, 18.8, 13.4, 5.3, 18.6, NA, 17, NA), c(NA, NA, 15.3, 11.1, 13, 16.7, 16, NA, NA, 19.3, 19.4, 12.3, 17.9, NA, 17.6, 15.9, 19.8, NA, NA, 18.9, 13.9, NA, 13.9, NA, 13.6, 17.5, NA, 19.6, 15.2, 13.9, 1, NA, 12.4, 14.9, 13.7, 18.8, NA, 17.6, 15.2, 14.9, 15.2, NA, 18.3, 15.8, 20.8, 12.5, NA, 16.5, 14.4, 5.6, 15.6, 19.2, NA,
            15.6, 10.9, NA, 13.2, 16.8, 11.6, 19.7, 14.7, 17.5, 18.6, NA, 19.8, 17.7, 2.1, 15, NA, NA, 20, 13.9, 9.1, 6.1, 6.4, 4.3, 13, NA, NA, 12, NA, NA, 13.3, NA, 16.9, 17.4, 15.3, 13.1, 11.5, 16, 12.8, 13.7, 20.4, 7.2, 13.2, 18.8, 18.8, 12.6, 18.3, 16.3, NA, 14.1, NA, NA, 19.4, NA, 13.7, 10.7, 9.1, 18.6, 20, NA, 17, 13.6, 11.7, 13.1, 8.4, 15.1, 13.7, 12.6, 16.9, 19.5, 13.8, 14, NA, NA, 16.7,
            NA, 15.6, 21, NA, 19, 4.3, 6.3, 14.4, 14.2, 7.8, 18.5, 17.7, 14.6, 18.8, 6.5, 16.3, NA, 15.5, 15.6, 13, 14, 13, 18.9, 19.1, NA, 4.4, 17.9, NA, 17.4, NA), c(NA, 15.4, NA, 7.1, 12.6, NA, 16.2, NA, NA, 19.4, 19.1, 12.2, 19.7, 14.1, NA, 15.7, 19.9, 20.4, NA, 19.3, 15.4, NA, NA, NA, NA, NA, NA, 19, 14.8, 13.6, 0.5, NA, 12.1, NA, 14.2, NA, NA, NA, 15, 14.8, 15.4, NA, 18.4, 15.6, 20.6, NA,
            NA, 16, 14.2, 5.5, 15.5, 19.3, 11.1, NA, 10.9, NA, NA, 16.9, NA, NA, 14.7, 17.1, NA, NA, 19.8, 17.7, NA, NA, NA, NA, 20.1, 13.4, 8.8, 6.1, 6.4, 3.6, 12.6, 12.6, NA, NA, NA, 20.4, 13.2, 19.5, 16.5, 17.5, NA, 13.2, 11.5, NA, 13, NA, 19.9, 7.2, 13.5, 18.7, NA, 12.4, 18.3, 15.1, NA, 13.9, 9.7, 17.3, 19.2, NA, 13.8, 10.7, 9, NA, NA, NA, 16.6, 13.1, 14.2, 12.9, NA, NA, 13.6, NA, 18.7, 19.2, 
            13.8, 13.9, 19.8, NA, 16.4, NA, NA, 20.8, 17.8, NA, 4.1, NA, 14.6, 14.3, 7.8, 18.8, NA, 14, 18.3, 6.3, NA, 13.8, 15.5, 15.6, 12.4, 12.8, 12.7, NA, 19.2, NA, 3.9, 17.4, NA, NA, 18.9)),
  
  max = c(c(NA, NA, NA, 23.4, 23.6, 24.8, 28.2, NA, NA, 30.8, 30.7, NA, 46, NA, NA, 28.5, 31, NA, NA, NA, 25.3, NA, 24.5, 31.9, 24.2, 28.6, 21.0, NA, NA, NA, 14.8, 29.2, 22.3, 25.4, NA, NA, NA, 30.3, 24.3, 26.5, 28.1, NA, 30.2, 25.7, 29.9, NA, NA, 26.9, NA, 22.3, 30.8, 29.9, 21.0, 30.6, 23.8, 22.6, NA, 28.7, 23.3, 30.9, 28.1, 28.1, NA, NA, NA, 29.4, NA, NA, 26.5, 30.8, 30.5, 24.5, 21.0, 17.8,
            21.6, 21.2, NA, 22.5, NA, 20.3, 20.7, 31, 26.4, 30.7, 24.7, 29.4, 30.4, 20.9, 24.8, NA, 24.5, 28.6, 30.2, 17, NA, NA, 30.3, 20.4, 30, 27.2, NA, NA, NA, 31.5, 30.4, 29.9, NA, 19.3, NA, 30.7, 29.6, NA, 28.3, 22.6, NA, 21.2, NA, NA, 27.7, NA, 31.4, 30.3, 25.5, 24.2, 31.3, 27.3, 27.1, NA, NA, 29.9, 30.6, 32.9, NA, 24.1, NA, NA, NA, 30.9, 31, NA, 31, NA, 29.3, 31.2, 29.8, 27.8, 22.9, 26.2,
            22.1, 30.4, 30, 24.6, 19.5, 30.7, 22.8, NA, NA), c(27.9, NA, 28.3, 21.9, 23.9, 25.5, 28.5, NA, NA, 30.6, 30.6, 25.5, 30.9, NA, NA, NA, 30.6, NA, NA, 30, 25.5, NA, NA, 32.3, 24.1, 29.3, NA, NA, 29.3, NA, 13.6, 29.4, 22, 25.5, NA, NA, NA, NA, 24.7, 28.2, NA, NA, 30.4, 25.5, 29.7, 21.3, NA, 27, NA, NA, 31.2, 30.5, 19.5, 30.6, NA, NA, 21.2, 29.1, 23.7, 30.5, NA, NA, NA, NA, 29.5, 29.6, NA,
            24.1, 26.7, NA, 30.6, NA, 21.2, 17.8, 21.9, 21.8, 22.9, 22.9, NA, 20.5, 21.2, 30.6, 25.9, 30.5, 25, 29.9, 30.7, 21.2, 25.1, NA, 24.9, 28.9, NA, NA, 25.6, 30.2, 30.2, 20.4, 30, 27.2, NA, NA, NA, 31.3, 30.4, 30.4, 25.1, 19.7, NA, 31.1, 29.6, NA, 27.3, 22.4, NA, 21.4, NA, NA, 25.9, NA, 31, 29.9, 25.4, NA, 30.7, 27, 27.5, NA, 25.4, NA, 30.7, 32.5, NA, NA, 26.8, NA, 16.5, 31.7, 31, 28.1, 30.6,
            NA, NA, 31.2, 29.3, NA, 23.3, 26.4, 22.5, 30.2, 30.1, 24.9, 19.2, 30.6, 22.9, NA, NA), c(NA, 26.9, NA, 23.3, 23.9, 26.1, 28.6, 28.3, NA, 31.3, 30.9, 26, 30.7, NA, 29.5, 29.2, 30.4, NA, NA, 30.3, 25, NA, NA, 32.2, 24.3, 29.3, NA, 31.2, 29.2, NA, 13.2, 29.6, 21.4, 24.5, NA, 31.5, NA, NA, 23.8, 27, 28.4, NA, 30, 25.1, 29.8, 18.2, NA, 27.6, NA, 22.7, 30.7, NA, NA, 30.6, NA, NA, 22.4, 29,
            23.5, 30.2, 28.1, 28.2, 30.2, NA, 30.3, 29.3, NA, 23.7, 26.3, 29.9, 31.1, NA, 20.9, 17.6, 21.5, 21.4, 23.9, 22.4, NA, 20.2, 20.9, 30.9, 26.1, 30.8, NA, 29.8, 30.9, 21.1, 25.4, NA, 24.7, 28.4, 30.5, 17.3, 25.5, 31.1, 31.1, 20.3, 30.1, 27.2, NA, 25.6, NA, 31.1, 30.4, 30.2, 25.1, 19.5, 22.3, 30.7, 30.2, NA, NA, 22.4, NA, NA, NA, NA, 28.7, NA, 31.1, 30.4, 25.4, 24.3, 31, NA, 27.3, NA, 25,
            30.3, 30.4, NA, 15.3, 20.1, 25.9, NA, NA, 31, 31, 26.5, 31.2, NA, NA, 31.8, 29.2, NA, NA, 26.5, 22.3, 30.4 , NA, 24, 19, 31.1, NA, 27.5, NA), c(30, NA, 28.5, 24.9, 24.9, 26.6, 29.4, NA, NA, 31.7, 31.6, 26.6, 31.5, NA, 29.3, NA, 31, NA, NA, 31.7, 25.5, NA, 27.9, NA, 24.5, 30.1, NA, 32.1, 29.7, 24.6, 14.5, NA, 22.6, 25.3, 25.3, 31.6, NA, 30.6, 24.3, 27.5, 29.5, NA, 31.2, 25.4, 30.1, 18.7,
            NA, 27.8, 23.2, 23.8, 31.1, 34, NA, 31.4, 23.8, NA, 21.9, 29.4, 23.8, 31.4, 28.8, 28.8, 31, NA, 30.4, 29.4, 14.6, 24, 27.6, NA, 31.4, 27.9, 21.6, 18.7, 22.2, 22.5, 24, 22.9, NA, 21, NA, NA, 26.3, NA, 24.8, 30.4, 31.7, 22.1, 26.5, 28.4, 25, 29.4, 31, 17.7, 26.7, 31.6, 31.6, NA, 31, 28.1, NA, 26.2, NA, 31.5, 30.6, 31, 25.7, 20.1, 23, 31.7, 31.4, NA, 27.9, 22.8, 22.5, 21.7, 18.3, 29.5, 29.8,
            21, 31.7, 30.7, 26.5, 25.2, NA, 27.1, 28, NA, 25.8, 31, 30.9, 32, 16.4, 21.8, 26, 27.3, 16.7, 32.4, 31.9, 26.9, 31.2, 16.7, 29.9, NA, 29.9, 28.2, 24.2, 26.7, 22.6, 30.7, 31.2, 24.4, 18.8, 32, NA, 28, NA), c(NA, 28.1, NA, 24.8, 24.5, NA, 29.6, NA, NA, 31.7, 31.5, 26.9, 31.8, 27.5, NA, 29.9, 31, 31.8, NA, 31.7, 25.8, NA, NA, NA, NA, NA, NA, 31.7, 28.9, 25.4, 14.4, NA, 22, NA, 21, NA, NA,
            NA, 24.4, 27, 29.1, NA, 31.2, 25.4, 30.5, NA, NA, 27.8, 23, 22.4, 30.8, 33.6, 20.8, NA, 23.7, NA, NA, 29.2, 24.1, NA, 28.8, 28.1, NA, NA, 30.4, 29.6, 14.4, NA, NA, NA, 31.2, 27, 21.4, 18.4, 21.6, 21.8, 23, 23.1, NA, NA, NA, 31.7, 26.2, 30.8, 24.9, 30.2, NA, 22, 25.9, NA, 25.4, NA, 31.1, 17.6, 26.6, 31.8, NA, 20.8, 30.8, 27.9, NA, 25.7, 23.5, 31.2, 30.7, NA, 25.3, 20, 22.7, NA, NA, NA,
            27.9, 22.8, 28.1, 21.5, NA, NA, 29.2, NA, 31.4, 30.5, 26.4, 25, 32.1, 27, 27.9, NA, NA, 30, 31, NA, NA, NA, 25.9, 27.6, 16.4, 32.1, NA, 26.5, 30.9, 16.3, NA, 32.1, 29.5, 28.2, 23.9, 26.3, 22.9, NA, 31.1, NA, 18.1, 31.8, NA, NA, NA)),
  
  avg = c(c(NA, NA, NA, 16.3, 16.6, 20.2, 22, NA, NA, 24.4, 24.9, NA, 36.7, NA, NA, 22.1, 25.2, NA, NA, NA, 18.8, NA, 18.7, 25.7, 18.7, 22.7, 16, NA, NA, NA, 7.4, 24, 16.8, 19.9, NA, NA, NA, 24.1, 18, 19.6, 21.4, NA, 24.1, 20.4, 25.1, NA, NA, 21.3, NA, 13.8, 23.4, 24.5, 14.9, 24.5, 17.4, 19.8, NA, 22.5, 16.3, 25.5, 21.6, 22.6, NA, NA, NA, 23.3, NA, NA, NA, 25, 25.1, 18.7, 14.9, 12, 13.6, 13.1,
            NA, 17.2, NA, 15.8, 15.4, 25.5, 19.7, 24.9, 20.3, 23.3, 24.5, 16.9, 18, NA, 18.6, 21.8, 25, 11.7, NA, NA, 24.6, 16.4, 24, 20.9, NA, NA, NA, 24.8, 24.7, NA, NA, 14.8, NA, 24.5, 24.6, NA, 22.2, 17, NA, 16.8, NA, NA, 20.6, NA, 24.6, 24.8, 19.4, 18.8, 24.4, 21.5, 21.6, NA, NA, 24.7, NA, 26.5, NA, 13.4, NA, NA, NA, 23.2, 23.7, NA, 24.3, NA, 23.3, 24.4, 22.7, 21.7, NA, 20.8, 17.1, 24.1,
            24.3, 18.2, 12.5, 24.3, 17.3, NA, NA), c(20.8, NA, 21.5, 14.7, 17.8, 20.8, 22.2, NA, NA, 24.6, 24.8, 18.3, 25.1, NA, NA, NA, 25, NA, NA, 24.8, 19.5, NA, NA, 25.7, 18.6, 23.3, NA, NA, 22, NA, NA, 24.3, 16.7, 19.7, NA, NA, NA, NA, 17.8, 20.9, NA, NA, 23.9, 20.4, 24.9, 16.7, NA, 21.5, NA, NA, 23.5, 24.7, 14, 24.4, NA, NA, 16.9, 22.6, 16.6, NA, NA, NA, NA, NA, 24.3, 23.4, NA, 18.7, NA, NA,
            25.2, NA, 14.9, 11.8, 13.4, 13.1, 17.4, 17.5, NA, 16, 15.7, 25.4, 19.5, 24.8, 20.6, 23.6, 24.5, 16.7, 18, NA, 18.7, 21.9, NA, NA, 18.5, 24.4, 24.4, 16.3, 23.9, 21.2, NA, NA, NA, 24.1, 24.5, NA, 18.6, 15.1, NA, 24.6, 24.5, NA, 21.9, 17.4, NA, 17, NA, NA, 19.8, NA, 24.9, 24.6, 19.3, NA, 25, 21.3, 21.7, NA, 19.7, NA, 24.3, 26.5, NA, NA, 20.6, NA, 11.7, NA, 24.1, 20.5, 24.1, NA, NA, 24, 22.4,
            NA, 17.8, 20.9, 17.4, 24.2, NA, 18.3, 12, 24.5, 17, NA, NA), c(NA, 21.1, NA, 15.7, 18.1, 21.1, 22.4, NA, NA, 25.4, 25.1, 19, 25.1, NA, 23.9, 22.3, 25.1, NA, NA, 24.9, 19.2, NA, NA, 25.8, 18.7, 23.3, NA, 25.5, 22, NA, NA, 24.6, 16.5, 19.3, NA, 24.1, NA, NA, 18.5, 20.4, 21.5, NA, 24, 20.3, 25.1, 15.1, NA, 22.1, NA, 13.6, 23.2, NA, NA, 24.6, NA, NA, 17.6, 22.7, 17.4, 25, 21.4, 22.6, 24.4,
            NA, 25, 23.3, NA, 18.8, NA, 24.4, 25.6, NA, 14.9, 11.7, 13.4, 12.9, 18.2, 17.2, NA, 15.9, 16.7, 25.6, 19.6, 25.1, NA, 23.6, 24.8, 16.5, 18.3, NA, 18.6, 21.7, 25.2, 11.8, 17.7, 24.9, 24.9, 16.2, 24.2, 21.5, NA, 19.6, NA, 23.9, 25, 23.4, 18.6, 14.9, 15.2, 24.6, 25, NA, NA, 17.6, NA, NA, NA, NA, 21.7, NA, 25, 24.8, 19, 18.9, 25.4, NA, 21.9, NA, 20, 25.5, 24.3, NA, 9.5, NA, 20.1, NA, NA,
            24.5, 24.4, 20, 24.8, NA, NA, 23.8, 22.3, NA, NA, 20.6, 17.4, 24.5, NA, 18.7, 12.1, 24.8, NA, 22.3, NA), c(NA, NA, 21.9, 18, 19, 21.6, 22.7, NA, NA, 25.5, 25.5, 19.5, 24.7, NA, 23.5, NA, 25.4, NA, NA, 25.3, 19.7, NA, 20.9, NA, 19.1, 23.8, NA, 25.9, 22.5, 19.3, 7.7, NA, 17.5, 20.1, 19.5, 25.2, NA, 24.1, 19.8, 21.2, 22.3, NA, 24.7, 20.6, 25.5, 15.6, NA, 22.1, 18.8, 14.7, 23.4, 26.6, NA,
            23.5, 17.4, NA, 17.5, 23.1, 17.7, 25.5, 21.7, 23.1, 24.8, NA, 25.1, 23.8, 8.3, 19.5, NA, NA, 25.7, 20.9, 15.3, 12.4, 14.3, 13.4, 18.5, NA, NA, 16.5, NA, NA, 19.8, NA, 20.9, 23.9, 23.5, 17.6, 19, 22.2, 18.9, 21.6, 25.7, 12.4, 19.9, 25.2, 25.2, NA, 24.6, 22.2, NA, 20.2, NA, NA, 25, NA, 19.7, 15.4, 16, 25.1, 25.7, NA, 22.4, 18.2, 17.1, 17.4, 13.3, 22.3, 21.7, 16.8, 24.3, 25.1, 20.2, 19.6,
            NA, NA, 22.3, NA, 20.7, 26, NA, 25.5, 10.4, 14, 20.2, 20.7, 12.2, 25.4, 24.8, 20.7, 25, 11.6, 23.1, NA, 22.7, 21.9, 18.6, 20.3, 17.8, 24.8, 25.1, NA, 11.6, 24.9, NA, 22.7, NA), c(NA, 21.8, NA, 15.9, 18.5, NA, 22.9, NA, NA, 25.5, 25.3, 19.5, 25.7, 20.8, NA, 22.8, 25.4, 26.1, NA, 25.5, 20.6, NA, NA, NA, NA, NA, NA, 25.3, 21.8, 19.5, 7.4, NA, 17, NA, 17.6, NA, NA, NA, 19.7, 20.9, 22.2,
            NA, 24.8, 20.5, 25.6, NA, NA, 21.9, 18.6, 14, 23.2, 26.4, 15.9, NA, 17.3, NA, NA, 23.1, NA, NA, 21.7, 22.6, NA, NA, 25.1, 23.6, NA, NA, NA, NA, 25.6, 20.2, 15.1, 12.3, 14, 12.7, 17.8, 17.9, NA, NA, NA, 26, 19.7, 25.1, 20.7, 23.8, NA, 17.6, 18.7, NA, 19.2, NA, 25.5, 12.4, 20, 25.2, NA, 16.6, 24.6, 21.5, NA, 19.8, 16.6, 24.3, 25, NA, 19.5, 15.4, 15.9, NA, NA, NA, 22.3, 18, 21.1, 17.2,
            NA, NA, 21.4, NA, 25.1, 24.9, 20.1, 19.4, 26, NA, 22.1, NA, NA, 25.4, 24.4, NA, NA, NA, 20.3, 20.9, 12.1, 25.5, NA, 20.2, 24.6, 11.3, NA, 23, 22.5, 21.9, 18.2, 19.6, 17.8, NA, 25.1, NA, 11, 24.6, NA, NA, NA))
)

dt <- data

## Load Data File ##
table <- read.csv("data.csv") 

## Set color for map ##
r_colors <- rgb(t(col2rgb(colors()) / 255))
names(r_colors) <- colors()


## ui.R ##
ui <- 
  dashboardPage(
    dashboardHeader(title = "Temperature Statistics"),
    dashboardSidebar(
      selectInput("Station", "Select a Station", choices = unique(data$station)),
      selectInput("Year", "Select a Year", list("2013", "2014", "2015", "2016", "2017"))
    ),
    
    dashboardBody(
      fluidRow(
        box(
          title = "Temperature of the Stations",
          width = 6,
          style = "overflow-x: scroll;",
          DT::dataTableOutput("csv_data_display")
        ),
        
        box( 
          title = "Coordinates of the Stations",
          DTOutput("table"), 
          width = 6
        ),
        
        box(
          title = "Map",
          width = 12,
          leafletOutput("map")
        )
      )
    )
  )



## server.R ##
server <- function(input, output) { 
  filtered_data <- reactive({
    table %>%
      filter(Station == input$station)
  })
  
  
  # Initialize the selected location
  selected_location <- reactiveVal()
  
  
  # Define the Leaflet map
  output$map <- renderLeaflet({
    leaflet(data = table, options = leafletOptions(minZoom = 6)) %>%
      addTiles(map,
               urlTemplate = "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png") %>%
      addMarkers(
        data = table,
        lat = ~Latitude,
        lng = ~Longitude,
        popup = ~Station) %>%
      
      setView(lng = 83.8620664929315, lat = 28.265600028199362, zoom = 7)
    
  })  
  
  ##options(max.print = 10000)
  
  
  # Display the table using DT
  output$table <- renderDT({
    datatable(table, options = list(
      pageLength = 10,
      selection = 'single'
    ))
  })
  
  # When a row in the table is clicked, update the selected location
  observeEvent(input$table_rows_selected, {
    if (length(input$table_rows_selected) > 0) {
      selected_location(table[input$table_rows_selected, c("Latitude", "Longitude")])
      leafletProxy("map") %>% setView(lat = selected_location()$Latitude, lng = selected_location()$Longitude, zoom = 12)
      
    }})
  
  
  output$csv_data_display <- DT::renderDataTable({
    print(dt)
  })
}


shinyApp(ui, server)
